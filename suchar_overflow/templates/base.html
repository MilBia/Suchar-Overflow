{% load static i18n %}

<!DOCTYPE html>
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>
      {% block title %}
        Suchar Overflow
      {% endblock title %}
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
          content="{% block description %}Agregator żartów o krytycznie niskim poziomie wilgotności.{% endblock description %}" />
    <meta name="author" content="Miłosz Białczak" />

    <!-- Open Graph -->
    <meta property="og:title"
          content="{% block og_title %}Suchar Overflow{% endblock og_title %}" />
    <meta property="og:description"
          content="{% block og_description %}Agregator żartów o krytycznie niskim poziomie wilgotności.{% endblock og_description %}" />
    <meta property="og:image"
          content="{% block og_image %}{% static 'images/favicons/favicon.ico' %}{% endblock og_image %}" />
    <meta property="og:url" content="{{ request.build_absolute_uri }}" />
    <link rel="icon" href="{% static 'images/favicons/favicon.ico' %}" />
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
          rel="stylesheet" />
    {% block css %}
      <!-- Latest compiled and minified Bootstrap CSS -->
      <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css"
            integrity="sha512-SbiR/eusphKoMVVXysTKG/7VseWii+Y3FdHrt0EpKgpToZeemhqHeZeLWLhJutz/2ut2Vw1uQEj2MbRF+TVBUA=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer" />
      <link href="{% static 'css/project.css' %}" rel="stylesheet" />
    {% endblock css %}
    {% block javascript %}
      <script defer
              src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.min.js"
              integrity="sha512-1/RvZTcCDEUjY/CypiMz+iqqtaoQfAITmNSJY17Myp4Ms5mdxPS5UV7iOfdZoxcGhzFbOm6sntTKJppjvuhg4g=="
              crossorigin="anonymous"
              referrerpolicy="no-referrer"></script>
      <script defer src="{% static 'js/project.js' %}"></script>
    {% endblock javascript %}
    <script>
      // Immediately invoke to prevent flash of wrong theme
      (function() {
        const localTheme = localStorage.getItem('theme');
        const theme = localTheme || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', theme);
      })();
    </script>
  </head>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg sticky-top">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center"
           href="{% url 'home' %}">
          <svg xmlns="http://www.w3.org/2000/svg"
               width="24"
               height="24"
               fill="currentColor"
               class="bi bi-cloud-haze2 me-2"
               viewBox="0 0 16 16">
            <path d="M8.5 2a5.001 5.001 0 0 1 4.905 4.027A3 3 0 0 1 13 12H3.5A3.5 3.5 0 0 1 .035 9H5.5a.5.5 0 0 0 0-1H.035a3.5 3.5 0 0 1 3.871-2.977A5.001 5.001 0 0 1 8.5 2m-6 8a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1zM0 13.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5" />
          </svg>
          Suchar Overflow
        </a>
        <button class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent"
                aria-expanded="false"
                aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'home' %}">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'suchary:list' %}">Suchary</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'about' %}">O projekcie</a>
            </li>
          </ul>
          <div class="d-flex align-items-center gap-2">
            <button id="theme-toggle" class="btn btn-link nav-link">
              <svg xmlns="http://www.w3.org/2000/svg"
                   width="20"
                   height="20"
                   fill="currentColor"
                   class="bi bi-moon-stars-fill"
                   viewBox="0 0 16 16">
                <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278" />
              </svg>
            </button>
            {% if request.user.is_authenticated %}
              <a class="nav-link"
                 href="{% url 'users:detail' request.user.username %}">
                <svg xmlns="http://www.w3.org/2000/svg"
                     width="20"
                     height="20"
                     fill="currentColor"
                     class="bi bi-person-circle me-1"
                     viewBox="0 0 16 16">
                  <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0" />
                  <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1" />
                </svg>
                {{ request.user.username }}
              </a>
              <a class="btn btn-outline-secondary btn-sm"
                 href="{% url 'account_logout' %}">Wyloguj</a>
              <a href="{% url 'suchary:add' %}" class="btn btn-primary btn-sm">Dodaj</a>
            {% else %}
              <a class="btn btn-outline-primary" href="{% url 'account_login' %}">Zaloguj</a>
              <a class="btn btn-primary" href="{% url 'account_signup' %}">Rejestracja</a>
            {% endif %}
          </div>
        </div>
      </div>
    </nav>
    <!-- Main Content -->
    <div class="main-wrapper">
      <div class="container mt-4">
        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-dismissible fade show {% if message.tags %}alert-{{ message.tags }}{% endif %}"
                 role="alert">
              {{ message }}
              <button type="button"
                      class="btn-close"
                      data-bs-dismiss="alert"
                      aria-label="Close"></button>
            </div>
          {% endfor %}
        {% endif %}
        {% block content %}
          <p>Domyślna treść.</p>
        {% endblock content %}
      </div>
    </div>
    <!-- Footer -->
    <footer class="footer">
      <div class="container text-center">
        <p class="text-muted mb-0">
          © {% now "Y" %} Suchar Overflow.
          <span class="d-block d-sm-inline mt-1 mt-sm-0">Wszelkie prawa zastrzeżone (ale żarty ukradzione).</span>
        </p>
      </div>
    </footer>
    {% block modal %}
    {% endblock modal %}
    {% block inline_javascript %}
    {% endblock inline_javascript %}
  </body>

</html>
