{% extends "users/base_dashboard.html" %}

{% load i18n %}
{% load allauth %}

{% block title %}
  {% trans "Two-Factor Authentication" %}
{% endblock title %}
{% block dashboard_content %}
  <div class="card shadow-sm border-0">
    <div class="card-header bg-transparent border-0 pt-4 px-4 pb-0">
      <h1 class="h3 fw-bold mb-0">{% trans "Two-Factor Authentication" %}</h1>
      <p class="text-muted small">Zarządzaj weryfikacją dwuetapową (MFA).</p>
    </div>
    <div class="card-body p-4">
      <p>
        {% blocktrans %}Two-factor authentication (2FA) adds an extra layer of security to your account. You will
            need to use an authentication app (such as Google Authenticator, Authy, or Microsoft Authenticator) to log
            in.{% endblocktrans %}
      </p>
      {% if authenticators %}
        {% url 'mfa_remove' as remove_url %}
        {% url 'mfa_view_codes' as view_codes_url %}
        {% url 'mfa_generate_codes' as generate_codes_url %}
        <div class="alert alert-success">
          <i class="bi bi-check-circle-fill me-2"></i>{% trans "MFA is currently enabled on your account." %}
        </div>
        <div class="d-grid gap-2">
          <a href="{% url 'mfa_view_codes' %}" class="btn btn-outline-primary">
            <i class="bi bi-eye me-2"></i>{% trans "View Recovery Codes" %}
          </a>
          <a href="{% url 'mfa_reauthenticate' %}?next={% url 'mfa_deactivate' %}"
             class="btn btn-outline-danger">
            <i class="bi bi-trash me-2"></i>{% trans "Disable MFA" %}
          </a>
        </div>
      {% else %}
        <div class="alert alert-warning">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>{% trans "MFA is not enabled." %}
        </div>
        <div class="d-grid">
          <a href="{% url 'mfa_activate_totp' %}" class="btn btn-primary">
            <i class="bi bi-shield-lock me-2"></i>{% trans "Activate MFA (TOTP)" %}
          </a>
        </div>
      {% endif %}
    </div>
  </div>
{% endblock dashboard_content %}
