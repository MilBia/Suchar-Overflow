{% extends "users/base_dashboard.html" %}

{% load i18n %}

{% block title %}
  {% trans "E-mail Addresses" %}
{% endblock title %}
{% block dashboard_content %}
  <div class="card shadow-sm border-0">
    <div class="card-header bg-transparent border-0 pt-4 px-4 pb-0">
      <h1 class="h3 fw-bold mb-0">{% trans "E-mail Addresses" %}</h1>
      <p class="text-muted small">ZarzÄ…dzaj swoimi adresami e-mail.</p>
    </div>
    <div class="card-body p-4">
      {% if user.emailaddress_set.all %}
        <p class="mb-3">{% trans 'The following e-mail addresses are associated with your account:' %}</p>
        <form action="{% url 'account_email' %}"
              class="email_list mb-5"
              method="post">
          {% csrf_token %}
          <div class="list-group mb-3">
            {% for emailaddress in user.emailaddress_set.all %}
              <div class="list-group-item d-flex align-items-center justify-content-between p-3">
                <div class="form-check m-0 d-flex align-items-center">
                  {% if emailaddress.primary %}
                    <input class="form-check-input me-3"
                           type="radio"
                           name="email"
                           checked
                           value="{{ emailaddress.email }}"
                           id="email_radio_{{ forloop.counter }}" />
                  {% else %}
                    <input class="form-check-input me-3"
                           type="radio"
                           name="email"
                           value="{{ emailaddress.email }}"
                           id="email_radio_{{ forloop.counter }}" />
                  {% endif %}
                  <label class="form-check-label" for="email_radio_{{ forloop.counter }}">
                    <span class="fw-medium">{{ emailaddress.email }}</span>
                    {% if emailaddress.verified %}
                      <span class="badge bg-success ms-2">{% trans "Verified" %}</span>
                    {% else %}
                      <span class="badge bg-warning text-dark ms-2">{% trans "Unverified" %}</span>
                    {% endif %}
                    {% if emailaddress.primary %}
                      <span class="badge bg-primary ms-1">{% trans "Primary" %}</span>
                    {% endif %}
                  </label>
                </div>
              </div>
            {% endfor %}
          </div>
          <div class="d-flex gap-2 flex-wrap">
            <button class="secondaryAction btn btn-primary btn-sm"
                    type="submit"
                    name="action_primary">{% trans "Make Primary" %}</button>
            <button class="secondaryAction btn btn-outline-secondary btn-sm"
                    type="submit"
                    name="action_send">{% trans "Re-send Verification" %}</button>
            <button class="primaryAction btn btn-outline-danger btn-sm"
                    type="submit"
                    name="action_remove">{% trans "Remove" %}</button>
          </div>
        </form>
      {% else %}
        <div class="alert alert-warning">
          {% blocktrans %}Warning: You currently do not have any e-mail address set up. You should really add an
      e-mail address so you can receive notifications, reset your password, etc.{% endblocktrans %}
        </div>
      {% endif %}
      <hr class="my-4" />
      <h2 class="h5 fw-bold mb-3">{% trans "Add E-mail Address" %}</h2>
      <form method="post" action="{% url 'account_email' %}" class="add_email">
        {% csrf_token %}
        {% include "includes/form.html" %}
        <div class="mt-3">
          <button class="btn btn-primary" name="action_add" type="submit">{% trans "Add E-mail" %}</button>
        </div>
      </form>
    </div>
  </div>
{% endblock dashboard_content %}
